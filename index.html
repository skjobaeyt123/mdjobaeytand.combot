<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AdBikash</title>
  <style>
    body { font-family: sans-serif; background: #f4f7fe; margin: 0; padding: 0; }
    header { background: #1a237e; color: #fff; padding: 15px; text-align: center; font-size: 20px; font-weight: bold; }
    .container { padding: 20px; }
    .card { background: #fff; border-radius: 12px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .btn { padding: 10px 15px; background: #1a73e8; color: white; border: none; border-radius: 8px; cursor: pointer; width: 100%; }
    .hidden { display: none; }
    input { width: 100%; padding: 10px; margin: 8px 0; border-radius: 6px; border: 1px solid #ccc; }
    a { color: #1a73e8; text-decoration: none; font-weight: bold; }
    .avatar { width: 80px; border-radius: 50%; margin-bottom: 10px; }
  </style>
</head>
<body>

<header>AdBikash</header>

<div class="container" id="welcomeScreen">
  <div class="card" style="text-align:center;">
    <img src="https://cdn-icons-png.flaticon.com/512/147/147144.png" alt="Welcome" class="avatar" />
    <h2>üéâ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ AdBikash ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ‡ßá!</h2>
    <p>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡ßá ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶∞‡¶ì ‡¶Ü‡ßü ‡¶ï‡¶∞‡ßÅ‡¶®!</p>
    <p>‚ö†Ô∏è ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ VPN ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßá üá∫üá∏ üá¨üáß üá®üá¶ üá©üá™ üá¶üá∫ ‡¶ï‡¶æ‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶¶‡¶ø‡ßü‡ßá ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
    <a href="https://t.me/ADANDINCAMMANYOfficialgroup" target="_blank">üì¢ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</a> |
    <a href="https://t.me/ADANDINCAMMANYOfficialgroup" target="_blank">üë• ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™</a><br><br>

    <button class="btn" onclick="handleStart()">‚ñ∂Ô∏è START</button>
    <button id="sessionClearBtn" class="btn hidden" onclick="clearSession()">üßπ ‡¶∏‡ßá‡¶∂‡¶® ‡¶ï‡ßç‡¶≤‡¶ø‡ßü‡¶æ‡¶∞</button>
  </div>
</div>

<div class="container hidden" id="loginScreen">
  <div class="card">
    <h3>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶¶‡¶ø‡¶®</h3>
    <input type="text" id="usernameInput" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®‡¶É user123" />
    <button class="btn" onclick="startApp()">‡¶ö‡¶æ‡¶≤‡¶ø‡ßü‡ßá ‡¶Ø‡¶æ‡¶®</button>
  </div>
</div>

<script>
function handleStart() {
  const saved = localStorage.getItem("activeUser");
  if (saved) {
    loadUser(saved);
  } else {
    document.getElementById("welcomeScreen").classList.add("hidden");
    document.getElementById("loginScreen").classList.remove("hidden");
  }
}

function clearSession() {
  if (confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶¨ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶ï‡ßç‡¶≤‡¶ø‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) {
    localStorage.clear();
    alert("‚úÖ ‡¶∏‡¶¨ ‡¶∏‡ßá‡¶∂‡¶® ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶ó‡ßá‡¶õ‡ßá!");
    location.reload();
  }
}

window.onload = () => {
  checkVPN();
  const saved = localStorage.getItem("activeUser");
  if (saved) {
    // Show START ‚Üí goes to home
    document.getElementById("welcomeScreen").classList.remove("hidden");
  } else {
    document.getElementById("welcomeScreen").classList.remove("hidden");
  }

  const tg = window.Telegram?.WebApp?.initDataUnsafe?.user;
  if (tg?.username === "Mdjobaeyt") {
    document.getElementById("sessionClearBtn").classList.remove("hidden");
  }
};

function checkVPN() {
  fetch("https://ipapi.co/json/")
    .then(res => res.json())
    .then(data => {
      const allowed = ["US", "GB", "CA", "DE", "AU"];
      if (!allowed.includes(data.country)) {
        document.body.innerHTML = "<h2 style='padding:20px;color:red;text-align:center;'>‚ö†Ô∏è VPN ‡¶¶‡¶ø‡ßü‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶∞‡¶æ‡¶∑‡ßç‡¶ü‡ßç‡¶∞, ‡¶á‡¶â‡¶ï‡ßá, ‡¶ï‡¶æ‡¶®‡¶æ‡¶°‡¶æ, ‡¶ú‡¶æ‡¶∞‡ßç‡¶Æ‡¶æ‡¶®‡¶ø ‡¶¨‡¶æ ‡¶Ö‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶≤‡¶ø‡ßü‡¶æ ‡¶ï‡¶æ‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶õ‡¶æ‡ßú‡¶æ ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶®‡¶ø‡¶∑‡¶ø‡¶¶‡ßç‡¶ß!</h2>";
      }
    });
}
</script><!-- Continue inside <body> -->

<div class="container hidden" id="home">
  <div class="card">
    <h3 id="userDisplay">Username</h3>
    <p><strong>‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏:</strong> <span id="balance">0</span> ‡¶ï‡ßü‡ßá‡¶®</p>
  </div>
  <div class="card">
    <h4>‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ï‡¶æ‡¶ú</h4>
    <p>‡¶Æ‡ßã‡¶ü ‡¶ï‡¶æ‡¶ú: ‚àû<br> ‡¶∂‡ßá‡¶∑ ‡¶π‡ßü‡ßá‡¶õ‡ßá: <span id="completed">0</span><br> ‡¶¨‡¶æ‡¶ï‡¶ø: ‚àû</p>
  </div>
  <div class="card">
    <h4>‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶Ü‡ßü</h4>
    <p>‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶Ü‡ßü: BDT <span id="todayEarning">0.00</span><br> ‡¶Æ‡ßã‡¶ü ‡¶Ü‡ßü: BDT <span id="lifetimeEarning">0.00</span></p>
  </div>
</div>

<div class="container hidden" id="earn">
  <div class="card">
    <h4>‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</h4>
    <p>‡¶Æ‡ßã‡¶ü: ‚àû | ‡¶∂‡ßá‡¶∑: <span id="completedEarn">0</span> | ‡¶¨‡¶æ‡¶ï‡¶ø: ‚àû</p>
    <button class="btn" id="adBtn" onclick="showAd()">üé¨ ‡¶ï‡¶æ‡¶ú ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <div id="cooldownMessage" class="hidden">
      <p>‡ßß ‡¶ò‡¶£‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡¶æ‡¶ú ‡¶¨‡¶®‡ßç‡¶ß ‡¶Ü‡¶õ‡ßá‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶™‡¶∞‡ßá ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
    </div>
    <div id="adContainer" style="margin-top:15px;"></div>
  </div>
</div>

<script src='//libtl.com/sdk.js' data-zone='9370281' data-sdk='show_9370281'></script>
<script>
let userData = {};
let adCooldown = false;

function startApp() {
  const username = document.getElementById("usernameInput").value.trim();
  if (!username) return alert("‡¶∏‡¶†‡¶ø‡¶ï ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶¶‡¶ø‡¶®");

  const userKey = "adsUser_" + username;
  const saved = localStorage.getItem(userKey);
  userData = saved ? JSON.parse(saved) : {
    coins: 50,
    completed: 0,
    completedEarn: 0,
    username,
    myCode: "REF" + Math.floor(Math.random() * 100000),
    referrals: [],
    withdrawn: false,
    referredBy: localStorage.getItem("pendingReferral") || null
  };

  localStorage.setItem("activeUser", username);
  localStorage.setItem(userKey, JSON.stringify(userData));
  document.getElementById("loginScreen").classList.add("hidden");
  document.getElementById("home").classList.remove("hidden");
  document.getElementById("navBar").classList.remove("hidden");
  updateUI();
}

function loadUser(username) {
  const userKey = "adsUser_" + username;
  const saved = localStorage.getItem(userKey);
  if (!saved) return;
  userData = JSON.parse(saved);
  document.getElementById("welcomeScreen").classList.add("hidden");
  document.getElementById("home").classList.remove("hidden");
  document.getElementById("navBar").classList.remove("hidden");
  updateUI();
}

function updateUI() {
  document.getElementById("userDisplay").innerText = userData.username;
  document.getElementById("balance").innerText = userData.coins;
  document.getElementById("completed").innerText = userData.completed;
  document.getElementById("completedEarn").innerText = userData.completedEarn || 0;
  document.getElementById("todayEarning").innerText = (userData.coins * 0.01).toFixed(2);
  document.getElementById("lifetimeEarning").innerText = (userData.coins * 0.01).toFixed(2);
}

function showAd() {
  const now = Date.now();
  if (userData.cooldownUntil && now < userData.cooldownUntil) {
    document.getElementById("cooldownMessage").classList.remove("hidden");
    return;
  }

  const btn = document.getElementById("adBtn");
  btn.disabled = true;
  btn.innerText = "‡ß¨ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...";
  setTimeout(() => {
    btn.innerText = "üé¨ Ad ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®";
    btn.disabled = false;
    const adDiv = document.createElement("div");
    adDiv.setAttribute("data-sdk", "show_9370281");
    document.getElementById("adContainer").innerHTML = "";
    document.getElementById("adContainer").appendChild(adDiv);
    if (window.show_9370281) {
      show_9370281();
      handleAdComplete();
    }
  }, 6000);
}

function handleAdComplete() {
  userData.completed++;
  userData.completedEarn = (userData.completedEarn || 0) + 1;
  const isRewardAd = userData.completed % 5 === 0;
  if (isRewardAd) {
    setTimeout(() => {
      const confirmClick = confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶® ‡¶è‡¶¨‡¶Ç ‡ßß‡ß´ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶õ‡¶ø‡¶≤‡ßá‡¶®?");
      if (confirmClick) {
        userData.coins += 50;
        alert("‚úÖ ‡¶Ü‡¶™‡¶®‡¶ø ‡ß´‡ß¶ ‡¶ï‡ßü‡ßá‡¶® ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶®!");
      } else {
        alert("‚ùå ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá‡¶®‡¶®‡¶ø ‡¶¨‡¶æ ‡¶∏‡¶Æ‡ßü ‡¶¶‡ßá‡¶®‡¶®‡¶ø, ‡¶ï‡ßã‡¶® ‡¶ï‡ßü‡ßá‡¶® ‡¶™‡¶æ‡¶¨‡ßá‡¶® ‡¶®‡¶æ‡•§");
      }
      finalizeAd();
    }, 15000);
  } else {
    userData.coins += 10;
    finalizeAd();
  }
}

function finalizeAd() {
  if (userData.completed >= 50) {
    const oneHourLater = Date.now() + 3600000;
    userData.cooldownUntil = oneHourLater;
    document.getElementById("cooldownMessage").classList.remove("hidden");
  }
  saveUserData();
  updateUI();
}

function saveUserData() {
  localStorage.setItem("adsUser_" + userData.username, JSON.stringify(userData));
}
</script><!-- Withdraw Screen -->
<div class="container hidden" id="withdraw">
  <div class="card">
    <h4>‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏: <span id="balanceWithdraw">0</span> ‡¶ï‡ßü‡ßá‡¶®</h4>
    <h4>‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</h4>
    <select id="method">
      <option value="">‡¶Æ‡ßá‡¶•‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</option>
      <option value="recharge">‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶∞‡¶ø‡¶ö‡¶æ‡¶∞‡ßç‡¶ú (‡ß´‡ß¶‡ß¶‡ß¶ ‡¶ï‡ßü‡ßá‡¶®)</option>
      <option value="bkash">bKash/Nagad (‡ßß‡ß¶‡ß¶‡ß¶‡ß¶ ‡¶ï‡ßü‡ßá‡¶®)</option>
    </select>
    <input type="number" id="amount" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" />
    <input type="text" id="wallet" placeholder="‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂/‡¶®‡¶ó‡¶¶ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞" />
    <button class="btn" onclick="submitWithdraw()">‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶¶‡¶ø‡¶®</button>
  </div>
</div>

<!-- Withdraw History -->
<div class="container hidden" id="withdrawHistory">
  <div class="card">
    <h3>üìú ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡¶∞‡¶ø</h3>
    <ul id="withdrawList"></ul>
  </div>
</div>

<script>
function submitWithdraw() {
  const method = document.getElementById("method").value;
  const amount = parseInt(document.getElementById("amount").value);
  const wallet = document.getElementById("wallet").value;
  if (!method || !amount || !wallet) return alert("‡¶∏‡¶ï‡¶≤ ‡¶ò‡¶∞ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®");

  const valid =
    (method === "recharge" && userData.coins >= 5000 && amount >= 25 && amount <= 50) ||
    (method === "bkash" && userData.coins >= 10000 && amount >= 50 && amount <= 100);

  if (!valid) return alert("‡¶Ö‡ßç‡¶Ø‡¶æ‡¶Æ‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶≠‡ßÅ‡¶≤ ‡¶¨‡¶æ ‡¶ï‡ßü‡ßá‡¶® ‡¶ï‡¶Æ ‡¶∞‡ßü‡ßá‡¶õ‡ßá");

  userData.coins -= (method === "recharge" ? 5000 : 10000);
  userData.withdrawn = true;
  addWithdrawHistory(amount, method, wallet);
  saveUserData();
  checkReferralCommission();
  updateUI();
  alert("‚úÖ ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®!");
}

function addWithdrawHistory(amount, method, wallet) {
  const key = "withdrawHistory_" + userData.username;
  const history = JSON.parse(localStorage.getItem(key) || "[]");
  history.push({ amount, method, wallet, date: new Date().toLocaleString() });
  localStorage.setItem(key, JSON.stringify(history));
}

function showWithdrawHistory() {
  const key = "withdrawHistory_" + userData.username;
  const history = JSON.parse(localStorage.getItem(key) || "[]");
  const list = document.getElementById("withdrawList");
  list.innerHTML = "";
  history.forEach(item => {
    const li = document.createElement("li");
    li.textContent = `${item.date} ‚Äî ${item.method} ‚Äî ${item.amount} BDT ‚Üí ${item.wallet}`;
    list.appendChild(li);
  });
}

function checkReferralCommission() {
  if (userData.referredBy && userData.completed >= 10 && userData.withdrawn && !userData.referralCommissionGiven) {
    const refKey = "adsUser_" + userData.referredBy;
    const refUserDataRaw = localStorage.getItem(refKey);
    if (refUserDataRaw) {
      const refUserData = JSON.parse(refUserDataRaw);
      refUserData.coins += 100;
      localStorage.setItem(refKey, JSON.stringify(refUserData));
      userData.referralCommissionGiven = true;
      saveUserData();
      alert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡¶æ‡¶∞ ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶® ‡ßß BDT ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®!");
    }
  }
}
</script><!-- Profile -->
<div class="container hidden" id="profile">
  <div class="card">
    <h3>‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</h3>
    <p>‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ: <span id="profileUsername"></span></p>
    <p>‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏: <span id="balanceProfile">0</span> ‡¶ï‡ßü‡ßá‡¶®</p>
    <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡ßã‡¶°:</p>
    <input type="text" id="myRefCode" readonly style="background:#eee;" />
    <p>‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï:</p>
    <input type="text" id="refLink" readonly style="background:#eee;" />
    <button class="btn" onclick="copyRefCode()">üìã ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</button>
  </div>

  <!-- Admin Panel (Mdjobaeyt only) -->
  <div class="card hidden" id="adminPanel">
    <img src="https://cdn-icons-png.flaticon.com/512/1995/1995574.png" class="avatar" />
    <h3>üëë Mdjobaeyt Admin Panel</h3>
    <label>üéØ CPM Rate:</label>
    <input type="number" id="cpmInput" value="5">
    <label>üéÅ Coins per 5 Ads:</label>
    <input type="number" id="rewardCoin" value="50">
    <button class="btn" onclick="saveAdminSettings()">üíæ Save Settings</button>
    <hr/>
    <h4>üì§ Withdraw Requests:</h4>
    <div id="withdrawRequests"></div>
    <hr/>
    <h4>üßë‚Äçüíº All Users:</h4>
    <div id="userListAdmin"></div>
    <hr/>
    <h4>üõ†Ô∏è Add/Subtract Coins:</h4>
    <input type="text" id="targetUser" placeholder="Username">
    <input type="number" id="targetCoin" placeholder="+/- Amount">
    <button class="btn" onclick="changeUserCoins()">‚úÖ Apply</button>
  </div>
</div>

<!-- Leaderboard -->
<div class="container hidden" id="leaderboard">
  <div class="card">
    <h3>üèÜ Top Earners</h3>
    <ol id="leaderboardList"></ol>
  </div>
  <div class="card">
    <h3>üë• Top Referrers</h3>
    <ol id="refBoardList"></ol>
  </div>
</div>

<!-- Navbar -->
<nav class="hidden" id="navBar">
  <button onclick="navigate('home')">üè† ‡¶π‡ßã‡¶Æ</button>
  <button onclick="navigate('earn')">üíº ‡¶ï‡¶æ‡¶ú</button>
  <button onclick="navigate('withdraw')">üí≥ ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞</button>
  <button onclick="navigate('leaderboard')">üèÜ ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°</button>
  <button onclick="navigate('withdrawHistory')">üìú ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡¶∞‡¶ø</button>
  <button onclick="navigate('profile')">üë§ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</button>
</nav><script>
function copyRefCode() {
  const copyText = document.getElementById("refLink");
  copyText.select();
  document.execCommand("copy");
  alert("‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
}

function showLeaderboard() {
  const allUsers = [];
  const refUsers = [];

  for (let key in localStorage) {
    if (key.startsWith("adsUser_")) {
      const data = JSON.parse(localStorage.getItem(key));
      if (data && data.coins) {
        allUsers.push({ username: data.username, coins: data.coins });
        refUsers.push({ username: data.username, referrals: data.referrals?.length || 0 });
      }
    }
  }

  allUsers.sort((a, b) => b.coins - a.coins);
  refUsers.sort((a, b) => b.referrals - a.referrals);

  const topEarn = allUsers.slice(0, 10);
  const topRef = refUsers.slice(0, 10);

  const list1 = document.getElementById("leaderboardList");
  const list2 = document.getElementById("refBoardList");

  list1.innerHTML = topEarn.map((u, i) => `<li>${i+1}. ${u.username} ‚Äî ${u.coins} ‡¶ï‡ßü‡ßá‡¶®</li>`).join('');
  list2.innerHTML = topRef.map((u, i) => `<li>${i+1}. ${u.username} ‚Äî ${u.referrals} ‡¶ú‡¶® ‡¶∞‡ßá‡¶´‡¶æ‡¶∞</li>`).join('');
}

function saveAdminSettings() {
  userData.cpm = parseFloat(document.getElementById("cpmInput").value);
  userData.rewardCoin = parseInt(document.getElementById("rewardCoin").value);
  localStorage.setItem("adsUser_" + userData.username, JSON.stringify(userData));
  alert("‚úÖ Settings Updated");
}

function loadAdminPanel() {
  if (userData.username === "Mdjobaeyt") {
    document.getElementById("adminPanel").classList.remove("hidden");
    loadWithdraws();
    loadAllUsers();
  }
}

function loadWithdraws() {
  const requests = [];
  for (let key in localStorage) {
    if (key.startsWith("withdrawHistory_")) {
      const history = JSON.parse(localStorage.getItem(key));
      const user = key.replace("withdrawHistory_", "");
      history.forEach(item => {
        requests.push(`<div>${user}: ${item.amount} (${item.method}) ‚Üí ${item.wallet}</div>`);
      });
    }
  }
  document.getElementById("withdrawRequests").innerHTML = requests.join('') || "‚ùå ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶á ‡¶®‡ßá‡¶á";
}

function loadAllUsers() {
  const list = [];
  for (let key in localStorage) {
    if (key.startsWith("adsUser_")) {
      const u = JSON.parse(localStorage.getItem(key));
      list.push(`<div>${u.username}: ${u.coins} ‡¶ï‡ßü‡ßá‡¶®, ${u.completed} ad, ${u.referrals?.length || 0} ‡¶∞‡ßá‡¶´‡¶æ‡¶∞</div>`);
    }
  }
  document.getElementById("userListAdmin").innerHTML = list.join('');
}

function changeUserCoins() {
  const user = document.getElementById("targetUser").value.trim();
  const amount = parseInt(document.getElementById("targetCoin").value);
  const key = "adsUser_" + user;
  const saved = localStorage.getItem(key);
  if (!saved) return alert("‚ùå ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø");

  const data = JSON.parse(saved);
  data.coins += amount;
  localStorage.setItem(key, JSON.stringify(data));
  alert(`‚úÖ ${user}-‡¶è‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶π‡ßü‡ßá‡¶õ‡ßá`);
  loadAllUsers();
}
</script><script>
// Navigate to page
function navigate(page) {
  document.querySelectorAll(".container").forEach(div => div.classList.add("hidden"));
  document.getElementById(page).classList.remove("hidden");
  updateUI();
  if (page === 'leaderboard') showLeaderboard();
  if (page === 'withdrawHistory') showWithdrawHistory();
  if (page === 'profile') loadAdminPanel();
}

// Referral system
function setupReferral(userKey) {
  const urlParams = new URLSearchParams(window.location.search);
  const ref = urlParams.get("ref");
  if (ref && ref !== userData.myCode && !userData.referredBy) {
    userData.referredBy = ref;
    userData.referrals = userData.referrals || [];
    userData.referrals.push(ref);
    saveUserData();
  }
}

// Copy Guide Button
function copyGuide() {
  const guide = `üß† High CPM Guide:\n\n‚úÖ VPN ‡¶¶‡¶ø‡ßü‡ßá USA ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®\n‚úÖ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ß´‡ß¶ ‡¶è‡¶° ‡¶™‡¶∞‡ßá IP ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®\n‚úÖ CPM = (Earn √∑ Impression) √ó 1000\n‚úÖ GEO-based traffic ‡¶¶‡¶ø‡¶®\n‚úÖ CPM 2‚Äì10$ ‡¶∞‡¶æ‡¶ñ‡¶§‡ßá ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®`;
  navigator.clipboard.writeText(guide);
  alert("‚úÖ ‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
}

// Optional: Admin editable Ad Code
function saveAdCode() {
  const code = document.getElementById("adCodeInput").value;
  localStorage.setItem("adminAdCode", code);
  alert("‚úÖ Ad Code Saved");
}

function loadAdCode() {
  const savedAd = localStorage.getItem("adminAdCode");
  if (savedAd && document.getElementById("adContainer")) {
    document.getElementById("adContainer").innerHTML = savedAd;
  }
}

// Load ad code on page load if exists
window.addEventListener("DOMContentLoaded", loadAdCode);
</script>
</body>
            </html>
