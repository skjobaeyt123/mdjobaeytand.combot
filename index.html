<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AdBikash</title>
  <style>
    body { font-family: sans-serif; background: #f4f7fe; margin: 0; padding: 0; }
    header { background: #1a237e; color: #fff; padding: 15px; text-align: center; font-size: 20px; font-weight: bold; }
    .container { padding: 20px; }
    .card { background: #fff; border-radius: 12px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .btn { padding: 10px 15px; background: #1a73e8; color: white; border: none; border-radius: 8px; cursor: pointer; width: 100%; }
    nav { position: fixed; bottom: 0; left: 0; right: 0; background: #fff; display: flex; justify-content: space-around; border-top: 1px solid #ccc; padding: 10px 0; }
    nav button { background: none; border: none; font-size: 14px; color: #1a237e; cursor: pointer; }
    .hidden { display: none; }
    input, select { width: 100%; padding: 10px; margin: 8px 0; border-radius: 6px; border: 1px solid #ccc; }
    a { display: block; color: #1a73e8; text-decoration: none; margin: 5px 0; font-weight: bold; }
  </style>
</head>
<body>
  <header>AdBikash</header>
  <div class="container" id="welcomeScreen">
    <div class="card" style="text-align: center;">
      <img src="welcome.jpg" alt="Welcome" style="width: 200px; border-radius: 10px; margin-bottom: 15px;" />
      <h2>ЁЯОЙ рж╕рзНржмрж╛ржЧрждржо AdBikash ржкрзНрж▓рзНржпрж╛ржЯржлрж░рзНржорзЗ!</h2>
      <p>ржПржЦрж╛ржирзЗ ржЕрзНржпрж╛ржб ржжрзЗржЦрзЗ ржЗржиржХрж╛ржо ржХрж░рзБржи, ржмржирзНржзрзБржжрзЗрж░ рж░рзЗржлрж╛рж░ ржХрж░рзБржи, ржЖрж░ ржмржЯ ржжрж┐рзЯрзЗ ржЙржЗржержбрзНрж░ ржирж┐ржи!</p>
      <p>тЪая╕П ржХрж╛ржЬ ржХрж░рждрзЗ рж╣рж▓рзЗ VPN ржЪрж╛рж▓рзБ ржХрж░рзБржиред ЁЯЗ║ЁЯЗ╕ ЁЯЗмЁЯЗз ЁЯЗиЁЯЗж ЁЯЗйЁЯЗк ЁЯЗжЁЯЗ║ ржЫрж╛рзЬрж╛ ржЕржирзНржп ржжрзЗрж╢ ржкрзНрж░ржмрзЗрж╢ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛ред</p>
      <a href="https://t.me/ADANDINCAMMANYOfficialgroup" target="_blank">ЁЯУв ржЪрзНржпрж╛ржирзЗрж▓</a>
      <a href="https://t.me/ADANDINCAMMANYOfficialgroup" target="_blank">ЁЯСе ржЧрзНрж░рзБржк</a>
      <button class="btn" onclick="goToLogin()">тЦ╢я╕П START</button>
      <button id="sessionClearBtn" class="btn" onclick="clearSession()" style="display: none;">ЁЯз╣ рж╕рзЗрж╢ржи ржХрзНрж▓рж┐рзЯрж╛рж░</button>
    </div>
  </div>

  <div class="container hidden" id="login">
    <div class="card">
      <h3>ржЖржкржирж╛рж░ ржЗржЙржЬрж╛рж░ржирзЗржо ржжрж┐ржи</h3>
      <input type="text" id="usernameInput" placeholder="ржпрзЗржоржиржГ user123" />
      <button class="btn" onclick="startApp()">ржЪрж╛рж▓рж┐ржпрж╝рзЗ ржпрж╛ржи</button>
    </div>
  </div>

  <div class="container hidden" id="home">
    <div class="card">
      <h3 id="userDisplay">Username</h3>
      <p><strong>ржмрзНржпрж╛рж▓рзЗржирзНрж╕:</strong> <span id="balance">0</span> ржХрзЯрзЗржи</p>
    </div>
    <div class="card">
      <h4>ржЖржЬржХрзЗрж░ ржХрж╛ржЬ</h4>
      <p>ржорзЛржЯ ржХрж╛ржЬ: тИЮ<br> рж╢рзЗрж╖ рж╣рзЯрзЗржЫрзЗ: <span id="completed">0</span><br> ржмрж╛ржХрж┐: тИЮ</p>
    </div>
    <div class="card">
      <h4>ржЖржЬржХрзЗрж░ ржЖрзЯ</h4>
      <p>ржЖржЬржХрзЗрж░ ржЖрзЯ: BDT <span id="todayEarning">0.00</span><br> ржорзЛржЯ ржЖрзЯ: BDT <span id="lifetimeEarning">0.00</span></p>
    </div>
  </div><div class="container hidden" id="earn">
    <div class="card">
      <h4>ржЖржЬржХрзЗрж░ ржЯрж╛рж╕рзНржХ</h4>
      <p>ржорзЛржЯ: тИЮ | рж╢рзЗрж╖: <span id="completedEarn">0</span> | ржмрж╛ржХрж┐: тИЮ</p>
      <button class="btn" id="adBtn" onclick="showAd()">ЁЯОм ржХрж╛ржЬ рж╢рзБрж░рзБ ржХрж░рзБржи</button>
      <div id="cooldownMessage" class="hidden">
        <p>рзз ржШржгрзНржЯрж╛рж░ ржЬржирзНржп ржХрж╛ржЬ ржмржирзНржз ржЖржЫрзЗред ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржкрж░рзЗ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржиред</p>
      </div>
      <div id="adContainer" style="margin-top:15px;"></div>
    </div>
    <div class="card">
      <h4>рж░рзЗржлрж╛рж░ ржХрзЛржб ржжрж┐ржи (ржРржЪрзНржЫрж┐ржХ):</h4>
      <input type="text" id="refInput" placeholder="рж░рзЗржлрж╛рж░ ржХрзЛржб рж▓рж┐ржЦрзБржи" />
    </div>
  </div>

  <div class="container hidden" id="withdraw">
    <div class="card">
      <h4>ржЙржкрж▓ржмрзНржз ржмрзНржпрж╛рж▓рзЗржирзНрж╕: <span id="balanceWithdraw">0</span> ржХрзЯрзЗржи</h4>
      <h4>ржЙржЗржержбрзНрж░ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржХрж░рзБржи</h4>
      <select id="method">
        <option value="">ржорзЗржержб рж╕рж┐рж▓рзЗржХрзНржЯ ржХрж░рзБржи</option>
        <option value="recharge">ржорзЛржмрж╛ржЗрж▓ рж░рж┐ржЪрж╛рж░рзНржЬ (рзлрзжрзжрзж ржХрзЯрзЗржи)</option>
        <option value="bkash">bKash/Nagad (рззрзжрзжрзжрзж ржХрзЯрзЗржи)</option>
      </select>
      <input type="number" id="amount" placeholder="ржЯрж╛ржХрж╛рж░ ржкрж░рж┐ржорж╛ржг рж▓рж┐ржЦрзБржи" />
      <input type="text" id="wallet" placeholder="ржмрж┐ржХрж╛рж╢/ржиржЧржж ржирж╛ржорзНржмрж╛рж░" />
      <button class="btn" onclick="submitWithdraw()">ржЙржЗржержбрзНрж░ ржжрж┐ржи</button>
    </div>
  </div>

  <div class="container hidden" id="profile">
    <div class="card">
      <h3>ржкрзНрж░рзЛржлрж╛ржЗрж▓</h3>
      <p>ржЗржЙржЬрж╛рж░ржирзЗржо: <span id="profileUsername"></span></p>
      <p>ржмрзНржпрж╛рж▓рзЗржирзНрж╕: <span id="balanceProfile">0</span> ржХрзЯрзЗржи</p>
      <p>ржЖржкржирж╛рж░ рж░рзЗржлрж╛рж░ ржХрзЛржб:</p>
      <input type="text" id="myRefCode" readonly style="background:#eee;" />
      <p>рж░рзЗржлрж╛рж░ рж▓рж┐ржВржХ:</p>
      <input type="text" id="refLink" readonly style="background:#eee;" />
      <button class="btn" onclick="copyRefCode()">ржХржкрж┐ ржХрж░рзБржи</button>
    </div>
  </div>

  <div class="container hidden" id="leaderboard">
    <div class="card">
      <h3>ЁЯПЖ ржЯржк рззрзж ржЖрж░рзНржирж╛рж░</h3>
      <ol id="leaderboardList"></ol>
    </div>
  </div>

  <div class="container hidden" id="withdrawHistory">
    <div class="card">
      <h3>ЁЯУЬ ржЙржЗржержбрзНрж░ рж╣рж┐рж╕рзНржЯрж░рж┐</h3>
      <ul id="withdrawList"></ul>
    </div>
  </div>

  <nav class="hidden" id="navBar">
    <button onclick="navigate('home')">ЁЯПа рж╣рзЛржо</button>
    <button onclick="navigate('earn')">ЁЯТ╝ ржХрж╛ржЬ</button>
    <button onclick="navigate('withdraw')">ЁЯТ│ ржЙржЗржержбрзНрж░</button>
    <button onclick="navigate('leaderboard')">ЁЯПЖ рж▓рж┐ржбрж╛рж░ржмрзЛрж░рзНржб</button>
    <button onclick="navigate('withdrawHistory')">ЁЯУЬ рж╣рж┐рж╕рзНржЯрж░рж┐</button>
    <button onclick="navigate('profile')">ЁЯСд ржкрзНрж░рзЛржлрж╛ржЗрж▓</button>
  </nav><script src='//libtl.com/sdk.js' data-zone='9370281' data-sdk='show_9370281'></script>
<script>
let userData = {};
let adCooldown = false;
let adClickCount = 0;
let lastAdTime = 0;

function goToLogin() {
  document.getElementById("welcomeScreen").classList.add("hidden");
  document.getElementById("login").classList.remove("hidden");
}

window.onload = () => {
  checkVPN();
  const savedUser = localStorage.getItem("activeUser");
  if (savedUser) {
    loadUser(savedUser);
  } else {
    document.getElementById("welcomeScreen").classList.remove("hidden");
  }

  const tg = window.Telegram?.WebApp?.initDataUnsafe?.user;
  if (tg?.username === "Mdjobaeyt") {
    document.getElementById("sessionClearBtn").style.display = "inline-block";
  }
};

function clearSession() {
  if (confirm("ржЖржкржирж┐ ржХрж┐ ржирж┐рж╢рзНржЪрж┐рждржнрж╛ржмрзЗ рж╕ржм ржЗржЙржЬрж╛рж░ ржбрзЗржЯрж╛ ржХрзНрж▓рж┐рзЯрж╛рж░ ржХрж░рждрзЗ ржЪрж╛ржи?")) {
    localStorage.clear();
    alert("рж╕ржХрж▓ рж╕рзЗрж╢ржи ржбрзЗржЯрж╛ ржорзБржЫрзЗ ржлрзЗрж▓рж╛ рж╣ржпрж╝рзЗржЫрзЗ!");
    location.reload();
  }
}

function startApp() {
  const username = document.getElementById("usernameInput").value.trim();
  if (!username) return alert("рж╕ржарж┐ржХ ржЗржЙржЬрж╛рж░ржирзЗржо ржжрж┐ржи");

  const userKey = "adsUser_" + username;
  const saved = localStorage.getItem(userKey);
  userData = saved ? JSON.parse(saved) : {
    coins: 50,
    completed: 0,
    completedEarn: 0,
    username,
    myCode: "REF" + Math.floor(Math.random() * 100000),
    referrals: [],
    withdrawn: false,
    referredBy: localStorage.getItem("pendingReferral") || null
  };

  localStorage.setItem("activeUser", username);
  localStorage.setItem(userKey, JSON.stringify(userData));
  document.getElementById("login").classList.add("hidden");
  document.getElementById("home").classList.remove("hidden");
  document.getElementById("navBar").classList.remove("hidden");
  updateUI();
  setupReferral(userKey);
}

function loadUser(username) {
  const userKey = "adsUser_" + username;
  const saved = localStorage.getItem(userKey);
  if (!saved) return;
  userData = JSON.parse(saved);
  document.getElementById("welcomeScreen").classList.add("hidden");
  document.getElementById("home").classList.remove("hidden");
  document.getElementById("navBar").classList.remove("hidden");
  updateUI();
}

function updateUI() {
  document.getElementById("userDisplay").innerText = userData.username;
  document.getElementById("profileUsername").innerText = userData.username;
  document.getElementById("balance").innerText = userData.coins;
  document.getElementById("balanceWithdraw").innerText = userData.coins;
  document.getElementById("balanceProfile").innerText = userData.coins;
  document.getElementById("completed").innerText = userData.completed;
  document.getElementById("completedEarn").innerText = userData.completedEarn || 0;
  document.getElementById("todayEarning").innerText = (userData.coins * 0.01).toFixed(2);
  document.getElementById("lifetimeEarning").innerText = (userData.coins * 0.01).toFixed(2);
  document.getElementById("myRefCode").value = userData.myCode;
  document.getElementById("refLink").value = location.origin + "?ref=" + userData.myCode;
}function showAd() {
  const now = Date.now();
  if (userData.cooldownUntil && now < userData.cooldownUntil) {
    document.getElementById("cooldownMessage").classList.remove("hidden");
    return;
  }

  const btn = document.getElementById("adBtn");
  btn.disabled = true;
  btn.innerText = "рзм рж╕рзЗржХрзЗржирзНржб ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рзБржи...";
  setTimeout(() => {
    btn.innerText = "ЁЯОм Ad ржжрзЗржЦрзБржи";
    btn.disabled = false;
    const adDiv = document.createElement("div");
    adDiv.setAttribute("data-sdk", "show_9370281");
    document.getElementById("adContainer").innerHTML = "";
    document.getElementById("adContainer").appendChild(adDiv);
    if (window.show_9370281) {
      show_9370281();
      handleAdComplete();
    }
  }, 6000);
}

function handleAdComplete() {
  userData.completed++;
  userData.completedEarn = (userData.completedEarn || 0) + 1;
  const isRewardAd = userData.completed % 5 === 0;
  if (isRewardAd) {
    setTimeout(() => {
      const confirmClick = confirm("ржЖржкржирж┐ ржХрж┐ ржмрж┐ржЬрзНржЮрж╛ржкржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзЗржЫрзЗржи ржПржмржВ рззрзл рж╕рзЗржХрзЗржирзНржб ржЫрж┐рж▓рзЗржи?");
      if (confirmClick) {
        userData.coins += 50;
        alert("тЬЕ ржЖржкржирж┐ рзлрзж ржХрзЯрзЗржи ржкрзЗрзЯрзЗржЫрзЗржи!");
      } else {
        alert("тЭМ ржЖржкржирж┐ ржХрзНрж▓рж┐ржХ ржХрж░рзЗржиржирж┐ ржмрж╛ рж╕ржорзЯ ржжрзЗржиржирж┐, ржХрзЛржи ржХрзЯрзЗржи ржкрж╛ржмрзЗржи ржирж╛ред");
      }
      finalizeAd();
    }, 15000);
  } else {
    userData.coins += 10;
    finalizeAd();
  }
}

function finalizeAd() {
  if (userData.completed >= 50) {
    const oneHourLater = Date.now() + 3600000;
    userData.cooldownUntil = oneHourLater;
    document.getElementById("cooldownMessage").classList.remove("hidden");
  }
  saveUserData();
  updateUI();
}

function saveUserData() {
  localStorage.setItem("adsUser_" + userData.username, JSON.stringify(userData));
}

function submitWithdraw() {
  const method = document.getElementById("method").value;
  const amount = parseInt(document.getElementById("amount").value);
  const wallet = document.getElementById("wallet").value;
  if (!method || !amount || !wallet) return alert("рж╕ржХрж▓ ржШрж░ ржкрзВрж░ржг ржХрж░рзБржи");
  const valid =
    (method === "recharge" && userData.coins >= 5000 && amount >= 25 && amount <= 50) ||
    (method === "bkash" && userData.coins >= 10000 && amount >= 50 && amount <= 100);
  if (!valid) return alert("ржЕрзНржпрж╛ржорж╛ржЙржирзНржЯ ржнрзБрж▓ ржмрж╛ ржХрзЯрзЗржи ржХржо рж░рзЯрзЗржЫрзЗ");
  userData.coins -= (method === "recharge" ? 5000 : 10000);
  userData.withdrawn = true;
  addWithdrawHistory(amount, method, wallet);
  saveUserData();
  checkReferralCommission();
  updateUI();
  alert("ржЙржЗржержбрзНрж░ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ рж╕ржорзНржкржирзНржи!");
}

function addWithdrawHistory(amount, method, wallet) {
  const key = "withdrawHistory_" + userData.username;
  const history = JSON.parse(localStorage.getItem(key) || "[]");
  history.push({ amount, method, wallet, date: new Date().toLocaleString() });
  localStorage.setItem(key, JSON.stringify(history));
}

function showWithdrawHistory() {
  const key = "withdrawHistory_" + userData.username;
  const history = JSON.parse(localStorage.getItem(key) || "[]");
  const list = document.getElementById("withdrawList");
  list.innerHTML = "";
  history.forEach(item => {
    const li = document.createElement("li");
    li.textContent = `${item.date} тАФ ${item.method} тАФ ${item.amount} BDT тЖТ ${item.wallet}`;
    list.appendChild(li);
  });
}

function copyRefCode() {
  const copyText = document.getElementById("refLink");
  copyText.select();
  document.execCommand("copy");
  alert("рж░рзЗржлрж╛рж░ рж▓рж┐ржВржХ ржХржкрж┐ рж╣рзЯрзЗржЫрзЗ!");
}

function setupReferral(userKey) {
  const refInput = document.getElementById("refInput");
  const usedRefKey = userKey + "_usedRef";
  if (!localStorage.getItem(usedRefKey) && refInput) {
    refInput.addEventListener("change", () => {
      const entered = refInput.value.trim();
      if (entered && entered !== userData.myCode) {
        localStorage.setItem(usedRefKey, "true");
        userData.referredBy = entered;
        saveUserData();
        updateUI();
        alert("тЬЕ рж░рзЗржлрж╛рж░ ржЧрзНрж░рж╣ржг рж╣рзЯрзЗржЫрзЗ!");
      } else {
        alert("тЭМ ржирж┐ржЬрзЗржХрзЗ рж░рзЗржлрж╛рж░ ржХрж░рж╛ ржпрж╛ржмрзЗ ржирж╛!");
      }
    });
  }
}

function checkReferralCommission() {
  if (userData.referredBy && userData.completed >= 10 && userData.withdrawn && !userData.referralCommissionGiven) {
    const refKey = "adsUser_" + userData.referredBy;
    const refUserDataRaw = localStorage.getItem(refKey);
    if (refUserDataRaw) {
      const refUserData = JSON.parse(refUserDataRaw);
      refUserData.coins += 100;
      localStorage.setItem(refKey, JSON.stringify(refUserData));
      userData.referralCommissionGiven = true;
      saveUserData();
      alert("ржЖржкржирж╛рж░ рж░рзЗржлрж╛рж░рж╛рж░ ржкрзЗрзЯрзЗржЫрзЗржи рзз BDT ржХржорж┐рж╢ржи!");
    }
  }
}

function navigate(page) {
  document.querySelectorAll(".container").forEach(div => div.classList.add("hidden"));
  document.getElementById(page).classList.remove("hidden");
  updateUI();
  if (page === 'leaderboard') showLeaderboard();
  if (page === 'withdrawHistory') showWithdrawHistory();
}

function showLeaderboard() {
  const allUsers = [];
  for (let key in localStorage) {
    if (key.startsWith("adsUser_")) {
      const data = JSON.parse(localStorage.getItem(key));
      if (data && data.coins) {
        allUsers.push({ username: data.username, coins: data.coins });
      }
    }
  }
  allUsers.sort((a, b) => b.coins - a.coins);
  const top10 = allUsers.slice(0, 10);
  const list = document.getElementById("leaderboardList");
  list.innerHTML = "";
  top10.forEach((user, i) => {
    const li = document.createElement("li");
    li.textContent = `${i + 1}. ${user.username} тАФ ${user.coins} ржХрзЯрзЗржи`;
    list.appendChild(li);
  });
}

function checkVPN() {
  fetch("https://ipapi.co/json/")
    .then(res => res.json())
    .then(data => {
      const allowed = ["US", "GB", "CA", "DE", "AU"];
      if (!allowed.includes(data.country)) {
        document.body.innerHTML = "<h2 style='padding:20px;color:red;text-align:center;'>тЪая╕П рж╢рзБржзрзБржорж╛рждрзНрж░ US, UK, CA, DE, AU ржжрзЗрж╢ ржерзЗржХрзЗ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рж╛ ржпрж╛ржмрзЗред VPN ржЪрж╛рж▓рзБ ржХрж░рзБржиред</h2>";
      }
    });
}
</script>
</body>
</html>